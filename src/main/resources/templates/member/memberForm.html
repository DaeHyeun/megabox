<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{/layout/basic::setContent(~{this::content})}">
    <th:block th:fragment="content">
        <h2>회원 가입 페이지</h2>
        <form action="/member/join" method="post">
            <div class="form-group">
                이메일
                <input type="email" required class="form-control" name="email" placeholder="이메일을 입력해주세요"/>
            </div>
            <div class="form-group">
                비밀번호
                <input type="password" class="form-control" name="password" placeholder="비밀번호를 입력해주세요"/>
            </div>
            <div class="form-group">
                이름
                <input type="text" required class="form-control" name="name" placeholder="이름을 입력해주세요"/>
            </div>

            <div class="form-group">
                주소
                <input type="text" class="form-control"  id="zipcode" name="zipcode" placeholder="우편번호 찾기 버튼을 클릭해주세요." readonly>
                <input type="button" class="btn btn-primary" value="우편번호 찾기" id="zipbtn" style="margin-left: 320px;">
                <input type="text" class="form-control" id="addr" name="addr" placeholder="주소" readonly>
                <input type="text"  class="form-control" id="addr_detail" name="addr_detail" placeholder="상세주소">
            </div>

            <div class="form-group">
                전화번호
                <input type="text" required class="form-control" name="pnumber" placeholder="전화번호를 입력해주세요"/>
            </div>
            <button type="submit" class="btn btn-primary">가입하기</button>
        </form>
        <script>
            //우편번호 검색 기능
            let zipbtn = document.querySelector("#zipbtn");
            zipbtn.addEventListener("click",()=>{
                new daum.Postcode({
                    oncomplete: function(data) {
                        console.log(data);
                        let fullAddr = "";
                        let extraAddr = "";

                        if (data.userSelectedType=='R'){
                            fullAddr =  data.roadAddress;
                        }else{
                            fullAddr = data.jibunAddress;
                        }

                        //extraAddr에 값 대입하기
                           if(data.bname !==''){
                            extraAddr += data.bname;
                        }
                        if(data.buildingName !==''){
                            extraAddr += (extraAddr !=='' ? ', '+data.buildingName : data.buildingName)
                        }

                        fullAddr += (extraAddr !=='' ? ' ('+extraAddr+')' : '');

                        document.querySelector("#addr").value = fullAddr;
                        document.querySelector("#zipcode").value= data.zonecode;
                        document.querySelector("#addr_detail").focus();
                        }
                }).open();
            });
        </script>
    </th:block>
</th:block>
</html>